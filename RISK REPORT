INCIDENT RESPONSE / RISK ASSESSMENT


We unpacked this file and identified the name and version of this bot
based on the reference of its .pdb file.

C:\Users\s\Desktop\Home\Code\Trik v2.5\Release\Trik.pdb

The loader will first decrypt its configuration file in its resource section.
The configuration is an array that defines the execution flow of the malware
including mutex names. Based on the configuration, it can also delete the
property of the file being downloaded from the internet by deleting this
the alternate data stream “{filename}:Zone.Identifier”. This will bypass
dialog window from browsers implying the file was downloaded from the
internet. This is an indication that the attackers using drive-by-download
as a means to install this bot.

WIKI: Drive-by downloads may happen when visiting a website, viewing an
e-mail message or by clicking on a deceptive pop-up window:[2] by clicking
on the window in the mistaken belief that, for example, an error report from
the computer's operating system itself is being acknowledged or a seemingly
innocuous advertisement pop-up is being dismissed. In such cases, the
"supplier" may claim that the user "consented" to the download, although the
user was in fact unaware of having started an unwanted or malicious software
download. Similarly if a person is visiting a site with malicious content,
the person may become victim to a drive-by download attack. That is, the
malicious content may be able to exploit vulnerabilities in the browser or
plugins to run malicious code without the user’s knowledge.[3]
(https://en.wikipedia.org/wiki/Drive-by_download)


This sample performs Anti-Analysis Checks for Malware Blacklisted Processes (.exe)
    "WUAUCLT.EXE" --
        The wuauclt.exe file is located in the folder C:\Windows\System32
        It Automatically checks with the Microsoft website for updates to the
        OS. It shows up on the Task Manager's processes list when it is waiting
        for a response, such as to confirm permission to download an update.

    "MSSECES.EXE" --
        Msseces.exe is the process used to run the graphical user interface
        of (MSE) Microsoft Security Essentials.  Without this process, you
        wouldn’t be able to adjust any of the settings in MSE, and you wouldn’t
        be able to see alerts from new malware threats.  If you take a look at
        this process in Task Manager, you’ll see the relative description of
        what this process does. It is part of Microsoft's Antivirus software suite.
        It provides pop-up alerts if Microsoft Security Essentials finds an issue.

    "MSACUI.EXE" --
        This file is located in the folder C:\Program Files\Windows Defender\
        and is a component of the Windows Defender Anti-spyware feature from
        Microsoft.

    "MRT.EXE" --
        Mrt.exe is the main executable used to run the Microsoft Removal Tool.
        It is not a core Windows process. The Microsoft Removal Tool was first
        released in 2005 for the Microsoft Windows operating system. It is a
        freely available tool and it scans your computer for some of the most
        common infections. If you turn on Automatic Updates in Windows, this
        tool will be downloaded and run on the second Tuesday of each month.
        It runs silently in the background unless it finds an infection.

    "RSTRUI.EXE" --
        System Restore is a recovery tool developed by Microsoft that allows
        users to revert their computer's state such as the registry and system
        files to a previous point in time. Introduced with Windows ME, System
        Restore is not made part of all Windows operating systems released ever
        since excluding Windows Server. System Restore allows users to change
        the System Restore configuration, roll back to an existing restore point
        or create a new restore point manually.




MALICIOUS INDICATORS
(1) Exploit/Shellcode
    > Writes shellcode and data to remote process "Manager.exe"

(2) Contains ability to start/interact with device drivers
    > DeviceIoControl@KERNEL32.DLL from Manager.exe (PID: 2868)

(3) Installation / Persistence
    > allocated memory in "Manager.exe" (Protection: "execute/read/write/")
    > allocated memory in "share.exe"

(4) Modifies System Registry Settings

(5) Interacts with the primary disk partition (i.e. PhysicalDrive0)



HIGHLY SUSPICIOUS INDICATORS:
(1) Tries to hide tracks of having downloaded files from the internet
    > "winmgr.exe" opened "%WINDIR%\M-50504508848879876012050406030\
        winmgr.exe:Zone.Identifier" with delete access

(2) Contains unusual entropy sections

(3) Makes branch decision directly after calling API functions that are environment-aware

(4) Contains ability to download files from the internet
    > InternetReadFile@WININET.DLL from Manager.exe

(5) Modifies auto-execute functionality by setting/creating a value in the registry details
    > (Access type: "SETVAL"; Path: "HKLM\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN";
        Key: "MICROSOFT WINDOWS MANAGER"; Value: "%TEMP%\M-505045023065300695032840693020\winmgr.exe")
    > (Access type: "SETVAL"; Path: "HKCU\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN";
        Key: "MICROSOFT WINDOWS MANAGER"; Value: "%TEMP%\M-505045023065300695032840693020\winmgr.exe")

(6) NETWORK Related
    > Found potential IP Address in binary/memory > 127.181.87.80
    > Contacts Domains:


(7) Spyware/Information Retrieval
    > Contains ability to enumerate processes/modules/threads
        > CreateToolhelp32Snapshot@KERNEL32.DLL from Manager.exe

(8) Installs hooks/patches the running process

(9) Contains PDB Pathways
        > "%USERPROFILE%\.....\Code\Trik v2.5\Release\Trik.pdb"

(10) Creates Mutex "t8"

(11) Contains the ability to lookup the windows account name

(12) Found several potential URLs in binary/memory

(13) Spawns new processes
        > DeviceManager.exe

(14) Runs Shell Commands
        > Manager.bat
        > DeviceManager.bat
