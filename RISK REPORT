INCIDENT RESPONSE / RISK ASSESSMENT


We unpacked this file and identified the name and version of this bot
based on the reference of its .pdb file.

C:\Users\s\Desktop\Home\Code\Trik v2.5\Release\Trik.pdb

The loader will first decrypt its configuration file in its resource section.
The configuration is an array that defines the execution flow of the malware
including mutex names. Based on the configuration, it can also delete the
property of the file being downloaded from the internet by deleting this
alternate data stream “{filename}:Zone.Identifier” file. This will bypass
dialog window from browsers implying the file was downloaded from the
internet. This is an indication that the attackers using drive-by-download
as a means to install this bot.









MALICIOUS INDICATORS
(1) Exploit/Shellcode
    > Writes shellcode and data to remote process "Manager.exe"

(2) Contains ability to start/interact with device drivers
    > DeviceIoControl@KERNEL32.DLL from Manager.exe (PID: 2868)

(3) Installation / Persistence
    > allocated memory in "Manager.exe" (Protection: "execute/read/write/")
    > allocated memory in "share.exe"

(4) Modifies System Registry Settings

(5) Interacts with the primary disk partition (i.e. PhysicalDrive0)



HIGHLY SUSPICIOUS INDICATORS:
(1) Tries to hide tracks of having downloaded files from the internet
    > "winmgr.exe" opened "%WINDIR%\M-50504508848879876012050406030\
        winmgr.exe:Zone.Identifier" with delete access

(2) Contains unusual entropy sections

(3) Makes branch decision directly after calling API functions that are environment-aware

(4) Contains ability to download files from the internet
    > InternetReadFile@WININET.DLL from Manager.exe

(5) Modifies auto-execute functionality by setting/creating a value in the registry details
    > (Access type: "SETVAL"; Path: "HKLM\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN";
        Key: "MICROSOFT WINDOWS MANAGER"; Value: "%TEMP%\M-505045023065300695032840693020\winmgr.exe")
    > (Access type: "SETVAL"; Path: "HKCU\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN";
        Key: "MICROSOFT WINDOWS MANAGER"; Value: "%TEMP%\M-505045023065300695032840693020\winmgr.exe")

(6) NETWORK Related
    > Found potential IP Address in binary/memory > 127.181.87.80
    > Contacts Domains:


(7) Spyware/Information Retrieval
    > Contains ability to enumerate processes/modules/threads
        > CreateToolhelp32Snapshot@KERNEL32.DLL from Manager.exe

(8) Installs hooks/patches the running process

(9) Contains PDB Pathways
        > "%USERPROFILE%\.....\Code\Trik v2.5\Release\Trik.pdb"

(10) Creates Mutex "t8"

(11) Contains the ability to lookup the windows account name

(12) Found several potential URLs in binary/memory

(13) Spawns new processes
        > DeviceManager.exe

(14) Runs Shell Commands
        > Manager.bat
        > DeviceManager.bat
